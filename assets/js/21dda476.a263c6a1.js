"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[4516],{9325:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>a,toc:()=>o});const a=JSON.parse('{"id":"incentivized-testnet/Signing-key aliasing","title":"Signing-key aliasing","description":"Validators need to be able to sign messages without their primary keys being","source":"@site/docs/incentivized-testnet/signing-key-aliasing.md","sourceDirName":"incentivized-testnet","slug":"/signing-key-aliasing","permalink":"/signing-key-aliasing","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":99,"frontMatter":{"id":"Signing-key aliasing","sidebar_position":99,"slug":"/signing-key-aliasing"},"sidebar":"tutorialSidebar","previous":{"title":"Phase 4 manual","permalink":"/phase-4-manual"},"next":{"title":"FACT tokenomics","permalink":"/tokenomics"}}');var s=i(4848),t=i(8453);const r={id:"Signing-key aliasing",sidebar_position:99,slug:"/signing-key-aliasing"},l="Signing-key aliasing",d={},o=[{value:"Process for signing-key aliasing",id:"process-for-signing-key-aliasing",level:2},{value:"1. Install the cardano-cli",id:"1-install-the-cardano-cli",level:3},{value:"2. Create a new payment address on mainnet",id:"2-create-a-new-payment-address-on-mainnet",level:3},{value:"Create a new verification (<code>vkey</code>) and signing (<code>skey</code>) key pair",id:"create-a-new-verification-vkey-and-signing-skey-key-pair",level:4},{value:"Build the new payment address",id:"build-the-new-payment-address",level:4},{value:"Calculate the <code>vkey</code> hash",id:"calculate-the-vkey-hash",level:4},{value:"3. Construct and send a self transaction with custom metadata",id:"3-construct-and-send-a-self-transaction-with-custom-metadata",level:3},{value:"What Orcfax will see",id:"what-orcfax-will-see",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"signing-key-aliasing",children:"Signing-key aliasing"})}),"\n",(0,s.jsx)(n.p,{children:"Validators need to be able to sign messages without their primary keys being\nmade available to a live networked node."}),"\n",(0,s.jsx)(n.p,{children:"If a node is compromised a primary signing key must remain safe for the node\noperator and the network itself."}),"\n",(0,s.jsxs)(n.p,{children:["For the node to be able to recover it must be possible to ",(0,s.jsx)(n.a,{href:"https://csrc.nist.gov/glossary/term/key_rotation",children:"rotate"}),"\nthe signing key while still keeping it associated with the user's license and\nstake."]}),"\n",(0,s.jsx)(n.p,{children:"We do this through signing-key aliasing."}),"\n",(0,s.jsx)(n.h2,{id:"process-for-signing-key-aliasing",children:"Process for signing-key aliasing"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Install the ",(0,s.jsx)(n.code,{children:"cardano-cli"})]}),"\n",(0,s.jsx)(n.li,{children:"Create a new payment address on mainnet"}),"\n",(0,s.jsx)(n.li,{children:"Construct and send a self transaction with custom metadata"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"At the end of this process a user will have a new (aliased) public/private key\nsigning pair that is linked to their accounts holding the Orcfax License and\nstaked $FACT."}),"\n",(0,s.jsx)(n.h3,{id:"1-install-the-cardano-cli",children:"1. Install the cardano-cli"}),"\n",(0,s.jsxs)(n.p,{children:["Operators will need to install the ",(0,s.jsx)(n.code,{children:"cardano-cli"})," which is distributed as part of\nthe ",(0,s.jsx)(n.a,{href:"https://github.com/IntersectMBO/cardano-node/releases",children:"cardano-node"}),". This can be done on your local machine."]}),"\n",(0,s.jsx)(n.p,{children:"Download the latest release asset for your platform (e.g linux, macos, or win64)\nand extract its contents."}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"cardano-cli"})," is accessed from the node's ",(0,s.jsx)(n.code,{children:"bin"})," folder, e.g. if installed in\nyour home directory: ",(0,s.jsx)(n.code,{children:"/home/<user>/cardano-node/bin/cardano-cli"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["Either move the contents of the bin folder to a directory that\u2019s part of your\nPATH (or add it to your PATH) e.g. in the example below, replacing ",(0,s.jsx)(n.code,{children:"<user>"})," with\nthe name of your user's home folder:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"export PATH=$PATH:/home/<user>/cardano-node/bin/\n"})}),"\n",(0,s.jsx)(n.p,{children:"To verify it is installed correctly, run:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"cardano-cli --version\n"})}),"\n",(0,s.jsx)(n.h3,{id:"2-create-a-new-payment-address-on-mainnet",children:"2. Create a new payment address on mainnet"}),"\n",(0,s.jsxs)(n.h4,{id:"create-a-new-verification-vkey-and-signing-skey-key-pair",children:["Create a new verification (",(0,s.jsx)(n.code,{children:"vkey"}),") and signing (",(0,s.jsx)(n.code,{children:"skey"}),") key pair"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"cardano-cli address key-gen \\\n --verification-key-file payment.vkey \\\n --signing-key-file payment.skey\n"})}),"\n",(0,s.jsx)(n.h4,{id:"build-the-new-payment-address",children:"Build the new payment address"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"cardano-cli address build \\\n --payment-verification-key-file payment.vkey \\\n --out-file payment.addr \\\n --mainnet\n"})}),"\n",(0,s.jsxs)(n.h4,{id:"calculate-the-vkey-hash",children:["Calculate the ",(0,s.jsx)(n.code,{children:"vkey"})," hash"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"cardano-cli address key-hash \\\n  --payment-verification-key-file payment.vkey \\\n  --out-file payment.hash\n"})}),"\n",(0,s.jsxs)(n.admonition,{type:"note",children:[(0,s.jsx)(n.p,{children:"At this point, you should have the following files in your working directory:"}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"payment.addr"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"payment.skey"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"payment.vkey"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"payment.hash"})}),"\n"]})]}),"\n",(0,s.jsxs)(n.p,{children:["You will need to send the contents of the ",(0,s.jsx)(n.code,{children:"payment.hash"})," file as part of the\ncustom metadata in the next step. It should look something like:\n",(0,s.jsx)(n.code,{children:"37bf5119bb8ea27ad0796f04951456ad16748001c78aea8cab2b49c0"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["Later, you will also need to make the ",(0,s.jsx)(n.code,{children:"payment.skey"})," created above available on\nthe collector node you will be running in the ITN. This is described further\n",(0,s.jsx)(n.a,{href:"/phase-1-manual#cron",children:"here"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"3-construct-and-send-a-self-transaction-with-custom-metadata",children:"3. Construct and send a self transaction with custom metadata"}),"\n",(0,s.jsx)(n.p,{children:"Finally, to complete the process, you will need to construct a transaction to\nyourself using the wallet that holds your Orcfax Validator License."}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsx)(n.p,{children:"You are only sending it back to yourself and will need to do this in the future\nif you need to alias your address again."})}),"\n",(0,s.jsxs)(n.p,{children:["The transaction ",(0,s.jsx)(n.strong,{children:"must"})," be constructed as follows:"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Send exactly ",(0,s.jsx)(n.code,{children:"1.24601"})," in ADA"]}),"\n",(0,s.jsxs)(n.li,{children:["Attach your Orcfax Validator License to the transaction ",(0,s.jsx)("br",{})," ",(0,s.jsx)(n.strong,{children:"(IMPORTANT:\nthis allows Orcfax to index the transaction using the policy ID.)"})]}),"\n",(0,s.jsx)(n.li,{children:"Add the custom metadata"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["The metadata label must be ",(0,s.jsx)(n.code,{children:'"674"'})," and must have the following 3 fields in\norder:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:'"REGISTER"'})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:'"ITN"'})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:'"<YOUR_PAYMENT_HASH>"'})}),"\n"]}),"\n",(0,s.jsxs)(n.admonition,{title:"N.B.",type:"info",children:[(0,s.jsx)(n.p,{children:"The metadata fields will need to be on separate lines so as to fit within the\nCardano metadata character limit (max-length: 64 bytes)."}),(0,s.jsx)(n.p,{children:"For more information, refer to the following Cardano transaction metadata\nspecifications:"}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://cips.cardano.org/cip/CIP-20",children:"CIP-20"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://developers.cardano.org/docs/transaction-metadata/#schema",children:"Schema"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://developers.cardano.org/docs/get-started/cardano-serialization-lib/transaction-metadata/#json-conversion",children:"JSON Conversion"})}),"\n"]})]}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsxs)(n.p,{children:["If using eternl wallet, you will need to click ",(0,s.jsx)(n.code,{children:"options"})," and then\n",(0,s.jsx)(n.code,{children:"Custom Metadata"})," to add the metadata. ",(0,s.jsx)(n.code,{children:"NoConversions"})," should be selected."]})}),"\n",(0,s.jsxs)(n.p,{children:["An example transaction that results in the correct metadata can be seen\n",(0,s.jsx)(n.a,{href:"https://cexplorer.io/tx/791c3d699f1236a227edd611dc6408034523b98858cd15b4b495415c2835a242/metadata#data",children:"here"})," and should look like this:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n    "674": {\n        "msg": ["REGISTER", "ITN", "<YOUR_PAYMENT_HASH>"]\n    }\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"If all looks good, sign and complete the transaction."}),"\n",(0,s.jsx)(n.h2,{id:"what-orcfax-will-see",children:"What Orcfax will see"}),"\n",(0,s.jsxs)(n.p,{children:["Orcfax will be monitoring the Cardano network for the ADA value (",(0,s.jsx)(n.code,{children:"1.24601"}),") and\nNFT policy ID (",(0,s.jsx)(n.code,{children:"0c6f22bfabcb055927ca3235eac387945b6017f15223d9365e6e4e43"}),")."]}),"\n",(0,s.jsx)(n.p,{children:"When a transaction is registered, metadata is expected, the message will be\nprocessed, and the sending address compared against all known license holders."}),"\n",(0,s.jsxs)(n.admonition,{title:"N.B.",type:"info",children:[(0,s.jsx)(n.p,{children:"If the wallet holds a validator license and the correct amount of staked $FACT\nit will be eligible for participation in the ITN."}),(0,s.jsx)(n.p,{children:"There is no need to deregister an address as this process only needs to be done\nto claim ITN rewards."}),(0,s.jsx)(n.p,{children:"If you find you have a need to change your secondary (aliased) address then you\ncan submit a new transaction and it will not affect your ability to participate\nin the ITN."})]}),"\n",(0,s.jsx)(n.p,{children:"Secondary (aliased) addresses, validator license wallets, and staked $FACT will\nbe checked at runtime at all times and so information about participation will\nremain up-to-date if validator licenses change hands."})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>l});var a=i(6540);const s={},t=a.createContext(s);function r(e){const n=a.useContext(t);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),a.createElement(t.Provider,{value:n},e.children)}}}]);